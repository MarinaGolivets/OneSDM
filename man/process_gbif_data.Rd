% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_gbif.R
\name{process_gbif_data}
\alias{process_gbif_data}
\title{Download and Process GBIF Occurrence Data for Specified Taxa}
\usage{
process_gbif_data(
  gbif_ids = NULL,
  model_dir = NULL,
  verbose = TRUE,
  start_year = 1981L,
  r_environ = ".Renviron",
  boundaries = c(-180L, 180L, -90L, 90L),
  max_uncertainty = 10L
)
}
\arguments{
\item{gbif_ids}{Character vector of GBIF taxon keys (as numeric strings) to
query. If \code{NULL}, attempts to retrieve from the \code{onestop_gbif_ids} option.}

\item{model_dir}{Character. Path to the modelling directory where data and
fitted models will be saved. This can not be \code{NULL} and should be the same
directory used for the same species data. This can also be set via the
\code{onestop_model_dir} option.}

\item{verbose}{Logical. If \code{TRUE}, prints progress and status messages.}

\item{start_year}{Integer. Minimum year for occurrence records (default:
1981).}

\item{r_environ}{Character. Path to \code{.Renviron} file containing GBIF
credentials (default: ".Renviron"). If \code{NULL}, attempts to retrieve from
the \code{onestop_r_environ} option. See \code{\link[ecokit:check_gbif]{ecokit::check_gbif()}} for more
details.}

\item{boundaries}{Numeric vector of length 4. Spatial boundaries as (left,
right, bottom, top) in decimal degrees (default: \code{c(-180L, 180L, -90L, 90L)} for global extent).}

\item{max_uncertainty}{Numeric. Maximum allowed spatial uncertainty in
kilometers (default: 10).}
}
\value{
(Invisibly) A named list with paths to the request, status, raw data,
and processed data files:
\itemize{
\item \code{gbif_request}: Path to the saved GBIF request object
(\code{data/gbif_request.RData}).
\item \code{gbif_status}: Path to the saved GBIF status object
(\code{data/gbif_status.RData}).
\item \code{gbif_data_raw}: Path to the downloaded raw GBIF data
(\code{data/gbif_data_raw.zip}).
\item \code{gbif_data}: Path to the processed and cleaned GBIF data
(\code{data/gbif_data.RData}).
}
}
\description{
Downloads, filters, and processes occurrence data from the
Global Biodiversity Information Facility (\href{https://gbif.org/}{GBIF}) for
specified taxon keys (GBIF IDs). The function handles data request,
download, cleaning, and conversion to an \code{sf} object, with options for
spatial and temporal filtering, uncertainty thresholds, and boundary
constraints.
}
\details{
The function performs the following steps:
\itemize{
\item Validates input parameters and environment.
\item Checks for existing processed data to avoid redundant downloads/requests.
\item Requests occurrence data from GBIF using the \code{rgbif} package, applying
filters for coordinates, geospatial issues, year, occurrence status, basis
of record, and spatial boundaries.
\item Downloads and reads the raw data, applying further cleaning:
\itemize{
\item Removes records with missing or low-precision coordinates.
\item Filters by spatial uncertainty and accepted taxonomic ranks.
\item Applies additional cleaning using the \code{CoordinateCleaner} package.
}
\item Converts the cleaned data to an \code{sf} object and saves it.
}
}
\examples{
\dontrun{
process_gbif_data(
  gbif_ids = c("1234567", "7654321"), model_dir = "path/to/model_dir")
}

}
\author{
Ahmed El-Gabbas
}
